# CVE
## CVE-2024-33844
<img width="998" alt="image" src="https://github.com/Entropy1110/Bugs/assets/100339292/2ee013e9-6a42-4444-a203-7cb5d6468ffa">

# About the bug/vuln
The mavlink_itf_reset_mission_data function does not sanitize the MAV_MISSION_TYPE(0, 1, 2, 255).
When you send MAVLink MISSION_COUNT payload with MAV_MISSION_TYPE=17, the 'control' crashes by freeing 0-filled memory addresses.


# PoC
### Environment
- All the propellers are removed for safety reasons.
- Connection Environment : Parrot ANAFI Thermal(1.8.2) <-> FreeFlight6(6.7.5, iOS11)
- Attacker : Ubuntu 22.04, running the Python code.


### Payload in python for reproducing crashes
<img width="587" alt="image(1)" src="https://github.com/Entropy1110/Bugs/assets/100339292/ba1ca0d1-7d99-448a-b691-ce2ee5404413">

### Result
<img width="718" alt="image" src="https://github.com/Entropy1110/Bugs/assets/100339292/e1648297-0dab-478c-a445-1b7d4bcbe242">

Motors in roll, sent payload.

<img width="718" alt="image" src="https://github.com/Entropy1110/Bugs/assets/100339292/b23bb8dd-587d-445b-a0a9-c552f8c65a64">

The connection between FreeFlight6 <--> Parrot ANAFI Thermal cut out.

### ETC.
You can reproduce the bug in [Sphinx(tested on ver-2.15.1)](https://developer.parrot.com/docs/sphinx/releasenotes.html#version-2-15-1), the Parrot drone firmware emulator.
